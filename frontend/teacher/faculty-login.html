<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty Login - PopQuiz</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton&family=Poppins:wght@300;400;600&display=swap');
        :root {
            --bg-color: #000;
            --text-color: #fff;
            --grid-color: rgba(255, 255, 255, 0.4);
            --border-color: #fff;
            --input-bg: #000;
            --text-muted: #ccc;
            --accent-color: #3498db;
        }
        body.light-mode {
            --bg-color: #f4f7f9;
            --text-color: #111827;
            --grid-color: rgba(0, 0, 0, 0.1);
            --border-color: #111827;
            --input-bg: #fff;
            --text-muted: #555;
            --accent-color: #2980b9;
        }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Poppins', sans-serif; overflow: hidden; background-color: var(--bg-color); color: var(--text-color); transition: background-color 0.3s ease, color 0.3s ease; }
        .login-container { display: flex; justify-content: center; align-items: center; flex-direction: column; width: 100%; height: 100%; background-color: var(--bg-color); color: var(--text-color); position: relative; text-align: center; }
        .grid-background { position: absolute; bottom: 0; left: 0; width: 100%; height: 50%; background-image: linear-gradient(to right, var(--grid-color) 1px, transparent 1px), linear-gradient(to bottom, var(--grid-color) 1px, transparent 1px); background-size: 40px 40px; transform-style: preserve-3d; transform: perspective(500px) rotateX(75deg); z-index: 0; }
        .header { position: absolute; top: 40px; left: 40px; right: 40px; z-index: 2; display: flex; justify-content: space-between; align-items: center;}
        .header-left { text-align: left; }
        .logo { font-family: 'Anton', sans-serif; font-size: 1.8rem; font-weight: 400; letter-spacing: 1px; }
        .back-arrow { display: block; font-size: 2rem; color: var(--text-color); text-decoration: none; margin-top: 5px; }
        .theme-toggle-btn { background: none; border: none; cursor: pointer; padding: 5px; }
        .theme-toggle-btn svg { width: 24px; height: 24px; stroke: var(--text-color); stroke-width: 2; fill: none; stroke-linecap: round; stroke-linejoin: round; transition: stroke 0.3s ease; }
        .theme-toggle-btn .icon-sun { display: none; }
        body.light-mode .theme-toggle-btn .icon-sun { display: block; }
        body.light-mode .theme-toggle-btn .icon-moon { display: none; }
        .login-form { position: relative; z-index: 1; width: 100%; max-width: 400px; padding: 20px; box-sizing: border-box; }
        .login-form h1 { font-size: 2.5rem; font-weight: 300; letter-spacing: 4px; margin-bottom: 50px; }
        .input-group { position: relative; margin-bottom: 35px; }
        .input-group label { position: absolute; top: -8px; left: 25px; background-color: var(--bg-color); padding: 0 10px; font-size: 0.8rem; color: var(--text-muted); }
        .input-field { width: 100%; padding: 14px 25px; background-color: transparent; border: 2px solid var(--border-color); border-radius: 50px; color: var(--text-color); font-size: 1rem; box-sizing: border-box; }
        .input-field:focus { outline: none; border-color: var(--accent-color); }
        .input-field:-webkit-autofill, .input-field:-webkit-autofill:hover, .input-field:-webkit-autofill:focus, .input-field:-webkit-autofill:active { -webkit-text-fill-color: var(--text-color) !important; transition: background-color 5000s ease-in-out 0s; box-shadow: 0 0 0px 1000px var(--input-bg) inset; }
        .login-button { width: 100%; padding: 14px 35px; border: 2px solid var(--border-color); border-radius: 50px; color: var(--text-color); background-color: transparent; text-decoration: none; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s ease; margin-top: 10px; }
        .login-button:hover { background-color: var(--border-color); color: var(--bg-color); }
        .links { width: 100%; display: flex; justify-content: flex-end; margin-top: -25px; margin-bottom: 25px; padding-right: 15px; box-sizing: border-box; }
        .links a { color: var(--text-muted); text-decoration: none; font-size: 0.8rem; }
        .links a:hover { text-decoration: underline; }
        .signup-link { margin-top: 30px; font-size: 0.9rem; color: var(--text-muted); }
        .signup-link a { color: var(--text-color); font-weight: 600; text-decoration: none; }
        .signup-link a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="grid-background"></div>
        <header class="header">
            <div class="header-left">
                <div class="logo">POPQUIZ</div>
                <a href="../index.html" class="back-arrow">&lt;</a>
            </div>
            <button class="theme-toggle-btn" id="theme-toggle" title="Toggle theme">
                <svg class="theme-icon icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
                <svg class="theme-icon icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </header>
        <div class="login-form">
            <h1>FACULTY LOGIN</h1>
            <form id="auth-form">
                <div class="input-group">
                    <label for="email">EMAIL</label>
                    <input type="email" id="email" class="input-field" required>
                </div>
                <div class="input-group">
                    <label for="password">PASSWORD</label>
                    <input type="password" id="password" class="input-field" required>
                </div>
                <div class="links">
                    <a href="#">Forgot Password?</a>
                </div>
                <button type="submit" class="login-button">LOGIN</button>
            </form>
            <p class="signup-link">Don't have an account? <a href="signup.html">Sign Up</a></p>
        </div>
    </div>
    
    <script>
        // Theme toggle functionality
        const themeToggleBtn = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('popquiz-theme') || 'dark';
        if (currentTheme === 'light') {
            document.body.classList.add('light-mode');
        }
        themeToggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            const theme = document.body.classList.contains('light-mode') ? 'light' : 'dark';
            localStorage.setItem('popquiz-theme', theme);
        });

        // Login functionality
        const authForm = document.getElementById('auth-form');
        authForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            if (!email || !password) {
                alert('Please enter both email and password.');
                return;
            }
            // Call backend /auth/login
            fetch('http://localhost:8000/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            }).then(r => r.json().then(data => ({ok: r.ok, status: r.status, body: data})))
            .then(result => {
                if (!result.ok) {
                    const errorMsg = result.body.detail || 'Login failed';
                    if (errorMsg.includes('verify your email')) {
                        alert(errorMsg + '\n\nPlease check your email inbox for the verification link. If you did not receive it, you can request a new one.');
                    } else {
                        alert(errorMsg);
                    }
                    return;
                }
                const token = result.body.token;
                localStorage.setItem('popquiz_token', token);
                alert('Authentication successful! Redirecting to your dashboard...');
                window.location.href = 'dashboard.html';
            }).catch(err => {
                console.error(err);
                alert('Unable to reach backend. Make sure the backend is running at http://localhost:8000');
            });
        });
    </script>
</body>
</html>

